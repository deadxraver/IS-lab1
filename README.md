# Лабораторная работа #1

## Вариант 513318

**Внимание! У разных вариантов разный текст задания!**

### Реализовать информационную систему, которая позволяет взаимодействовать с объектами класса

`Route`, описание которого приведено ниже:

```java
public class Route {
	private Long id; //Поле не может быть null, Значение поля должно быть больше 0, Значение этого поля должно быть уникальным, Значение этого поля должно генерироваться автоматически
	private String name; //Поле не может быть null, Строка не может быть пустой
	private Coordinates coordinates; //Поле не может быть null
	private java.time.ZonedDateTime creationDate; //Поле не может быть null, Значение этого поля должно генерироваться автоматически
	private Location from; //Поле не может быть null
	private Location to; //Поле может быть null
	private int distance; //Значение поля должно быть больше 1
	private Long rating; //Поле не может быть null, Значение поля должно быть больше 0
}

public class Coordinates {
	private double x;
	private float y;
}

public class Location {
	private long x;
	private Integer y; //Поле не может быть null
	private String name; //Поле не может быть null
}
```

### Разработанная система должна удовлетворять следующим требованиям:

* Основное назначение информационной системы - управление объектами, созданными на основе заданного в варианте класса.
* Необходимо, чтобы с помощью системы можно было выполнить следующие операции с объектами: создание нового объекта,
  получение информации об объекте по ИД, обновление объекта (модификация его атрибутов), удаление объекта. Операции
  должны
  осуществляться в отдельных окнах (интерфейсах) приложения. При получении информации об объекте класса должна также
  выводиться информация о связанных с ним объектах.
* При создании объекта класса необходимо дать пользователю возможность связать новый объект с объектами вспомогательных
  классов, которые могут быть связаны с созданным объектом и уже есть в системе.
* Выполнение операций по управлению объектами должно осуществляться на серверной части (не на клиенте), изменения должны
  синхронизироваться с базой данных.
* На главном экране системы должен выводиться список текущих объетов в виде таблицы (каждый атрибут объекта - отдельная
  колонка в таблице). При отображении таблицы должна использоваться пагинация (если все объекты не помещаются на одном
  экране).
* Нужно обеспечить возможность фильтровать/сортировать строки таблицы, которые показывают объекты (по значениям любой из
  строковых колонок). Фильтрация элементов должна производиться по неполному совпадению.
* Переход к обновлению (модификации) объекта должен быть возможен из таблицы с общим списком объектов и из области с
  визуализацией объекта (при ее реализации).
* При добавлении/удалении/изменении объекта, он должен автоматически появиться/исчезнуть/измениться в интерфейсах у
  других
  пользователей, авторизованных в системе.
* Если при удалении объекта с ним связан другой объект, связанные объекты должны быть связаны с другим объектом (по
  выбору
  пользователя), а изначальный объект удален.
* Пользователи должны иметь возможность просмотра всех объектов. Для модификации объекта должно открываться отдельное
  диалоговое окно. При вводе некорректных значений в поля объекта должны появляться информативные сообщения о
  соответствующих ошибках.

### В системе должен быть реализован отдельный пользовательский интерфейс для выполнения специальных операций над объектами:

* Удалить один (любой) объект, значение поля rating которого эквивалентно заданному.
* Вернуть количество объектов, значение поля rating которых больше заданного.
* Вернуть массив уникальных значений поля rating по всем объектам.
* Найти самый короткий (или длинный) маршрут между указанными пользователем локациями.
* Найти все маршруты между указанными пользователем локациями, отсортировать список по заданному параметру.

Представленные операции должны быть реализованы в рамках компонентов бизнес-логики приложения без прямого использования
функций и процедур БД.

### Особенности хранения объектов, которые должны быть реализованы в системе:

* Организовать хранение данных об объектах в реляционной СУБД (PostgreSQL). Каждый объект, с которым работает ИС, должен
  быть сохранен в базе данных.
* Все требования к полям класса (указанные в виде комментариев к описанию классов) должны быть выполнены на уровне ORM и
  БД.
* Для генерации поля `id` использовать средства базы данных.
* Для подключения к БД на кафедральном сервере использовать хост `pg`, имя базы данных - `studs`, имя
  пользователя/пароль
  совпадают с таковыми для подключения к серверу.

### При создании системы нужно учитывать следующие особенности организации взаимодействия с пользователем:

* Система должна реагировать на некорректный пользовательский ввод, ограничивая ввод недопустимых значений и информируя
  пользователей о причине ошибки.
* Переходы между различными логически обособленными частями системы должны осуществляться с помощью меню.
* При добавлении/удалении/изменении объекта, он должен автоматически появиться/исчезнуть/измениться на области у всех
  других клиентов.

### При разработке ИС должны учитываться следующие требования:

* В качестве основы для реализации ИС необходимо использовать Jakarta EE, CDI beans.
* Для создания уровня хранения необходимо использовать JPA + EclipseLink.
* Разные уровни приложения должны быть отделены друг от друга, разные логические части ИС должны находиться в отдельных
  компонентах.

### Содержание отчёта:

1. Текст задания.
1. UML-диаграммы классов и пакетов разработанного приложения.
1. Исходный код системы или ссылка на репозиторий с исходным кодом.
1. Выводы по работе.

### Вопросы к защите лабораторной работы:

1. Шаблоны проектирования и архитектурные шаблоны.
1. Платформа Jakarta EE. Виды компонентов.
1. Jakarta EE. Управляемые бины. CDI-бины.
1. Концепция ORM. Библиотеки ORM Hibernate и EclipseLink. Особенности, API, сходства и отличия.
1. Технология Jakarta Persistence. Особенности, API, интеграция с ORM-провайдерами.
1. Технология Jakarta Data.
1. Платформа Spring. Сходства и отличия с Java EE.
1. Spring Boot.
1. Spring Data.

# Лабораторная работа #2

## Вариант _xml_

Доработать ИС из ЛР1 следующим образом:

* Добавить в систему возможность массового добавления объектов при помощи импорта файла. Формат для импорта необходимо
  согласовать с преподавателем. Импортируемый файл должен загружаться на сервер через интерфейс разработанного
  веб-приложения.
    * При реализации логики импорта объектов необходимо реализовать транзакцию таким образом, чтобы в случае
      возникновения ошибок при импорте, не был создан ни один объект.
    * При импорте должна быть реализована проверка пользовательского ввода в соответствии с ограничениями предметной
      области из ЛР1.
    * При наличии вложенных объектов в основной объект из ЛР1 необходимо задавать значения полей вложенных объектов в
      той же записи, что и основной объект.
* Необходимо добавить в систему интерфейс для отображения истории импорта (обычный пользователь видит только операции
  импорта, запущенные им).
    * В истории должны отображаться id операции, статус ее завершения, пользователь, который ее запустил, число
      добавленных объектов в операции (только для успешно завершенных).
* Согласовать с преподавателем и добавить в модель из первой лабораторной новые ограничения уникальности, проверяемые на
  программном уровне (эти новые ограничения должны быть реализованы в рамках бизнес-логики приложения и не должны быть
  отображены/реализованы в БД).
* Реализовать сценарий с использованием Apache JMeter, имитирующий одновременную работу нескольких пользователей с ИС, и
  проверить корректность изоляции транзакций, используемых в ЛР. По итогам исследования поведения системы при ее
  одновременном использовании несколькими пользователями изменить уровень изоляции транзакций там, где это требуется.
  Обосновать изменения.
    * Реализованный сценарий должен покрывать создание, редактирование, удаление и импорт объектов.
    * Реализованный сценарий должен проверять корректность поведения системы при попытке нескольких пользователей
      обновить и\или удалить один и тот же объект (например, двух администраторов).
    * Реализованный сценарий должен проверять корректность соблюдения системой ограничений уникальности предметной
      области при одновременной попытке нескольких пользователей создать объект с одним и тем же уникальным значением.

# Лабораторная работа #3

## Вариант 513344

Доработать ИС из ЛР2 следующим образом:

* Осуществить подключение к базе данных через Connection Pool:
    * использовать HikariCP
    * в отчете к лабораторной работе описать параметры конфигурации, которые использовались для настройки пула
      соединений
* Добавить L2 JPA Cache:
    * в качестве реализации использовать Infinispan
    * реализовать в приложении возможность включения/отключения логирования статистики об использовании L2 JPA Cache (
      cache hits, cache misses) ~~Если ваша лабораторная работа основана на Spring - для осуществления данной возможности
      использовать AOP;~~ если приложение на Jakarta EE - использовать CDI Interceptors
    * в отчете к лабораторной работе описать параметры конфигурации, которые вы использовали для настройки L2-кэша и как
      они влияют на уровень хранения
* Реализовать сохранение загруженных на сервер файлов, используемых для импорта данных, в файловом хранилище MinIO (
  можно взять любое другое S3-совместимое хранилище). Поднять и настроить MinIO требуется самостоятельно. Загруженные
  файлы должны быть доступны для скачивания из таблицы с логом импорта.
* Сохранение загруженных файлов в файловом хранилище должно быть реализовано транзакционно по отношению к операциям,
  реализующим непосредственную вставку объектов в БД при импорте.
* Для реализации распределенной транзакции из пункта 2 разрешается использовать любые инструменты. Рекомендуется решать
  задачу при помощи собственной реализации двухфазного коммита на уровне бизнес-логики приложения.
* Необходимо на защите быть готовым продемонстрировать корректность реализованной распределенной транзакции в следующих
  условиях:
    * отказ файлового хранилища (БД продолжает работать)
    * отказ БД (файловое хранилище продолжает работать)
    * ошибка в бизнес-логике сервера (работают и БД, и файловое хранилище, однако в коде сервера вылетает
      RuntimeException между запросами в разные источники данных)
* Необходимо:
    * на защите быть готовым продемонстрировать корректность работы распределенной транзакции в условиях параллельных
      запросов от нескольких пользователей (реализованный в ЛР 2 сценарий для Apache JMeter, тестирующий функцию
      импорта, должен продолжать корректно отрабатывать)
    * в отчете привести примеры ситуаций, которые могут возникать при осуществлении параллельных запросов от нескольких
      пользователей в вашем приложении, и описать, как ваша реализация обрабатывает такие ситуации
* После окончания демонстрации лабораторной работы ваше приложение и все запущенные элементы окружения, необходимые для
  работы приложения, должны быть остановлены.